<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <script>
            (function() {
                window.addEventListener('message', onMessage, false);
                var interval = setInterval(function() { parent.postMessage('ping', 'http://moon2016.zombull.xyz:3000'); }, 100);

                function onMessage(event) {
                    if (event.origin === 'http://moon2016.zombull.xyz:3000') {
                        if (event.data === 'pong') {
                            clearInterval(interval);
                        }
                        else if (event.data.method === 'get') {
                            event.source.postMessage({ key: event.data.key, value: localStorage.getItem(event.data.key) }, event.origin);
                        }
                        else if (event.data.method === 'set') {
                            localStorage.setItem(event.data.key, event.data.value);
                        }
                    }
                }
            })();
        </script>
    </body>
</html>
